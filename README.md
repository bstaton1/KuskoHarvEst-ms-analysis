
> This repository stores the code and data used to perform the analysis presented in the manuscript *In-season monitoring of harvest and effort form a large-scale subsistence salmon fishery in western Alaska* by authors B. Staton, W. Bechtol, L. Coggins, G. Decossas, and J. Esquible.
>
> **The manuscript is under review.**

[![ArticleDOI](https://img.shields.io/badge/Article-PLACEHOLDER%20IF%20ACCEPTED-blue?logo=doi&logoColor=f5f5f5)]()  
[![GitHub Repo Archive DOI](https://img.shields.io/badge/GitHub%20Repo%20Archive-PLACEHOLDER%20WHEN%20MINTED-blue?logo=github)]()

## Repository Structure

| Subdirectory               | Description                                                                                                |
|:---------------------------|:-----------------------------------------------------------------------------------------------------------|
| `effort-simulation/`       | Scripts to perform all simulation evaluations of the effort estimator and plot the results                 |
| `validation/`              | Scripts and data to perform the comparison of in-season harvest estimates to post-season harvest estimates |
| `session-setup.R`          | Loads packages, sets directories, creates miscellaneous objects used throughout several scripts            |
| `make-figures.R`           | Creates all figures, except those for the effort simulation                                                |
| `make-tables.R`            | Creates all numerical table output                                                                         |
| `make-in-text-summaries.R` | Calculates a variety of summary statistics that are presented the methods and results text                 |

## Dependencies

### ’KuskoHarv\*’ Package Family

Users will need to install the R package [‘KuskoHarvData’](https://github.com/bstaton1/KuskoHarvData).
From any R console, run:

``` r
install.packages("remotes")
remotes::install_github("bstaton1/KuskoHarvData", ref = "v2023.5")
```

‘KuskoHarvData’ stores information generated by the in-season harvest monitoring program, including:

- Meta data for each opener (`data(openers_all, package = "KuskoHarvData")`)
- Interview data (`data(interview_data_all, package = "KuskoHarvData")`)
- Flight data (`data(flight_data_all, package = "KuskoHarvData")`)
- Harvest estimates (`data(harv_est_all, package = "KuskoHarvData")`)
- Effort estimates (`data(effort_est_all, package = "KuskoHarvData")`)

Two other packages (and their dependencies) will simultaneously be installed: <img src="https://github.com/bstaton1/KuskoHarvPred/blob/v2023.3/inst/rstudio/KuskoHarvPred-tool/resources/all-logo-grouped.png?raw=true" align="right" height="250px"/>

- [‘KuskoHarvEst’](https://github.com/bstaton1/KuskoHarvEst) ([v1.3.0](https://github.com/bstaton1/KuskoHarvEst/releases/tag/v1.3.0)): contains the workflow to produce harvest estimates from interview and flight data (calculations described in the manuscript).
- [‘KuskoHarvUtils’](https://github.com/bstaton1/KuskoHarvUtils) ([v0.2.0](https://github.com/bstaton1/KuskoHarvUtils/releases/tag/v0.2.0)): contains several helper functions used throughout the ‘KuskoHarv\*’ family of packages.

To ensure installation of the exact package versions used upon publication, install these packages as follows:

``` r
remotes::install_github("bstaton1/KuskoHarvUtils", ref = "v0.2.0")
remotes::install_github("bstaton1/KuskoHarvEst", ref = "v1.3.0")
```

### CRAN Packages

The table below shows all R packages (and their versions at time of publication; *typically* should not matter, included for completeness) that are specifically called (typically with `pkg::fn()`) or loaded (using `library(pkg)`).
Users will need to have these packages installed prior to executing any of the code in this repo.

<details>
<summary>
<b>Click to Expand/Hide Packages Table</b>
</summary>

| Package                                                            | Version | Description                                                                                                                                                     |
|:-------------------------------------------------------------------|--------:|:----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [`dplyr`](https://CRAN.R-project.org/package=dplyr)                |   1.1.4 | A Grammar of Data Manipulation                                                                                                                                  |
| [`grid`](https://CRAN.R-project.org/package=grid)                  |   4.4.1 | The Grid Graphics Package                                                                                                                                       |
| [`gridExtra`](https://CRAN.R-project.org/package=gridExtra)        |     2.3 | Miscellaneous Functions for “Grid” Graphics                                                                                                                     |
| [`htmltools`](https://CRAN.R-project.org/package=htmltools)        | 0.5.8.1 | Tools for HTML                                                                                                                                                  |
| [`kableExtra`](https://CRAN.R-project.org/package=kableExtra)      |   1.4.0 | Construct Complex Table with ‘kable’ and Pipe Syntax                                                                                                            |
| [`knitr`](https://CRAN.R-project.org/package=knitr)                |    1.48 | A General-Purpose Package for Dynamic Report Generation in R                                                                                                    |
| [`KuskoHarvEst`](https://www.github.com/bstaton1/KuskoHarvEst)     |   1.3.0 | Tools for Producing In-season Estimates of Salmon Harvest and Effort Occurring in Short-Duration Subsistence Harvest Opportunities in the Lower Kuskokwim River |
| [`KuskoHarvUtils`](https://www.github.com/bstaton1/KuskoHarvUtils) |   0.2.0 | Utility Functions to Support ‘KuskoHarv’ Family of Packages                                                                                                     |
| [`latex2exp`](https://CRAN.R-project.org/package=latex2exp)        |   0.9.6 | Use LaTeX Expressions in Plots                                                                                                                                  |
| [`lubridate`](https://CRAN.R-project.org/package=lubridate)        |   1.9.3 | Make Dealing with Dates a Little Easier                                                                                                                         |
| [`png`](https://CRAN.R-project.org/package=png)                    |   0.1.8 | Read and write PNG images                                                                                                                                       |
| [`reshape2`](https://CRAN.R-project.org/package=reshape2)          |   1.4.4 | Flexibly Reshape Data: A Reboot of the Reshape Package                                                                                                          |
| [`rmarkdown`](https://CRAN.R-project.org/package=rmarkdown)        |    2.27 | Dynamic Documents for R                                                                                                                                         |
| [`scales`](https://CRAN.R-project.org/package=scales)              |   1.3.0 | Scale Functions for Visualization                                                                                                                               |
| [`stringr`](https://CRAN.R-project.org/package=stringr)            |   1.5.1 | Simple, Consistent Wrappers for Common String Operations                                                                                                        |
| [`this.path`](https://CRAN.R-project.org/package=this.path)        |   2.5.0 | Get Executing Script’s Path                                                                                                                                     |

</details>

Running the code below will display the packages not already installed on your machine:

``` r
pkgs <- c("dplyr", "grid", "gridExtra", "htmltools", "kableExtra", "knitr", "KuskoHarvEst", "KuskoHarvUtils", "latex2exp", "lubridate", "png", "reshape2", "rmarkdown", "scales", "stringr", "this.path")
pkgs[!pkgs %in% rownames(installed.packages())]
```

## Reproducing Article Content

To reproduce all content presented in the manuscript, open [RStudio](https://posit.co/download/rstudio-desktop/) to the `KuskoHarvEst-ms-analysis.Rproj` location and execute:

``` r
source("make-figures.R")                   # exports PNG files for manuscript
source("make-tables.R")                    # exports CSV files for manuscript
source("make-in-text-summaries.R")         # examine output line-by-line, output saved
source("effort-simulation/simple-sim.R")   # exports a figure
source("effort-simulation/complex-sim.R")  # may take an hour or more; exports a figure
```

After executing this code, the there will be two new subdirectories: `figures` and `tables` storing the content used in building the manuscript.

## Session Info

<details>
<summary>
<b>Click to Expand/Hide Session Info</b>
</summary>

    ## ─ Session info ───────────────────────────────────────────────────────────────
    ##  setting  value
    ##  version  R version 4.4.1 (2024-06-14 ucrt)
    ##  os       Windows 11 x64 (build 22631)
    ##  system   x86_64, mingw32
    ##  ui       RTerm
    ##  language (EN)
    ##  collate  English_United States.utf8
    ##  ctype    English_United States.utf8
    ##  tz       America/Los_Angeles
    ##  date     2024-08-31
    ##  pandoc   3.1.11 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)
    ## 
    ## ─ Packages ───────────────────────────────────────────────────────────────────
    ##  ! package        * version date (UTC) lib source
    ##    cli              3.6.3   2024-06-21 [1] CRAN (R 4.4.1)
    ##    colorspace       2.1-1   2024-07-26 [1] CRAN (R 4.4.1)
    ##    digest           0.6.36  2024-06-23 [1] CRAN (R 4.4.1)
    ##    dplyr          * 1.1.4   2023-11-17 [1] CRAN (R 4.4.1)
    ##    evaluate         0.24.0  2024-06-10 [1] CRAN (R 4.4.1)
    ##    fansi            1.0.6   2023-12-08 [1] CRAN (R 4.4.1)
    ##    fastmap          1.2.0   2024-05-15 [1] CRAN (R 4.4.1)
    ##    generics         0.1.3   2022-07-05 [1] CRAN (R 4.4.1)
    ##    glue             1.7.0   2024-01-09 [1] CRAN (R 4.4.1)
    ##    gridExtra      * 2.3     2017-09-09 [1] CRAN (R 4.4.1)
    ##    gtable           0.3.5   2024-04-22 [1] CRAN (R 4.4.1)
    ##    htmltools      * 0.5.8.1 2024-04-04 [1] CRAN (R 4.4.1)
    ##    kableExtra     * 1.4.0   2024-01-24 [1] CRAN (R 4.4.1)
    ##    knitr          * 1.48    2024-07-07 [1] CRAN (R 4.4.1)
    ##    KuskoHarvEst   * 1.3.0   2024-08-14 [1] Github (bstaton1/KuskoHarvEst@186fd4a)
    ##    KuskoHarvUtils * 0.2.0   2024-08-14 [1] Github (bstaton1/KuskoHarvUtils@a8e6faa)
    ##    latex2exp      * 0.9.6   2022-11-28 [1] CRAN (R 4.4.1)
    ##    lifecycle        1.0.4   2023-11-07 [1] CRAN (R 4.4.1)
    ##    lubridate      * 1.9.3   2023-09-27 [1] CRAN (R 4.4.1)
    ##    magrittr         2.0.3   2022-03-30 [1] CRAN (R 4.4.1)
    ##    munsell          0.5.1   2024-04-01 [1] CRAN (R 4.4.1)
    ##    pillar           1.9.0   2023-03-22 [1] CRAN (R 4.4.1)
    ##    pkgconfig        2.0.3   2019-09-22 [1] CRAN (R 4.4.1)
    ##    plyr             1.8.9   2023-10-02 [1] CRAN (R 4.4.1)
    ##    png            * 0.1-8   2022-11-29 [1] CRAN (R 4.4.0)
    ##    R6               2.5.1   2021-08-19 [1] CRAN (R 4.4.1)
    ##    Rcpp             1.0.13  2024-07-17 [1] CRAN (R 4.4.1)
    ##    renv             1.0.7   2024-04-11 [1] CRAN (R 4.4.1)
    ##    reshape2       * 1.4.4   2020-04-09 [1] CRAN (R 4.4.1)
    ##    rlang            1.1.4   2024-06-04 [1] CRAN (R 4.4.1)
    ##    rmarkdown      * 2.27    2024-05-17 [1] CRAN (R 4.4.1)
    ##    rstudioapi       0.16.0  2024-03-24 [1] CRAN (R 4.4.1)
    ##    scales         * 1.3.0   2023-11-28 [1] CRAN (R 4.4.1)
    ##    sessioninfo      1.2.2   2021-12-06 [1] CRAN (R 4.4.1)
    ##    stringi          1.8.4   2024-05-06 [1] CRAN (R 4.4.0)
    ##    stringr        * 1.5.1   2023-11-14 [1] CRAN (R 4.4.1)
    ##    svglite          2.1.3   2023-12-08 [1] CRAN (R 4.4.1)
    ##    systemfonts      1.1.0   2024-05-15 [1] CRAN (R 4.4.1)
    ##  D this.path      * 2.5.0   2024-06-29 [1] CRAN (R 4.4.1)
    ##    tibble           3.2.1   2023-03-20 [1] CRAN (R 4.4.1)
    ##    tidyselect       1.2.1   2024-03-11 [1] CRAN (R 4.4.1)
    ##    timechange       0.3.0   2024-01-18 [1] CRAN (R 4.4.1)
    ##    utf8             1.2.4   2023-10-22 [1] CRAN (R 4.4.1)
    ##    vctrs            0.6.5   2023-12-01 [1] CRAN (R 4.4.1)
    ##    viridisLite      0.4.2   2023-05-02 [1] CRAN (R 4.4.1)
    ##    xfun             0.46    2024-07-18 [1] CRAN (R 4.4.1)
    ##    xml2             1.3.6   2023-12-04 [1] CRAN (R 4.4.1)
    ##    yaml             2.3.10  2024-07-26 [1] CRAN (R 4.4.1)
    ## 
    ##  [1] C:/Users/bstaton/AppData/Local/R/win-library/4.4
    ##  [2] C:/Program Files/R/R-4.4.1/library
    ## 
    ##  D ── DLL MD5 mismatch, broken installation.
    ## 
    ## ──────────────────────────────────────────────────────────────────────────────

</details>
